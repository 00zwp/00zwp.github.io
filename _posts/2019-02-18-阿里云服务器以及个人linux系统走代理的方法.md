---
layout:     post
title:      阿里云服务器以及个人linux系统走代理的方法
subtitle:    ""
date:       2019-02-18
author:     tianhaoo
header-img: post-bg/img/24.jpg
catalog: true
tags:
  - 翻墙
  - linux
---

# 总体介绍

之前写过一篇使用squid+proxychain实现类似功能的博客，但在实际应用中发现不少问题。经过一段时间的摸索后制定了新的计划。

# 前提条件

首先要有一个shadowsocks的服务端，ip、密码、加密协议已知

# shadowsocks

## 安装shadowsocks客户端

```
sudo apt install shadowsocks
```

## 新建一个配置文件ss.json

格式和ssserver的配置文件相同

```
{
    "server":"1.1.1.1",
    "server_port":8388,
    "local_address": "127.0.0.1",
    "local_port":1080,
    "password":"your passwd",
    "timeout":300,
    "method":"aes-256-cfb"
}
```

## 通过命令行启动shadowsocks客户端

```
sslocal -c ss.json -d start
```

至此便可以根据配置文件在本地的1080端口开设一个socks5协议的代理通道。

# privoxy

这里用到privoxy主要是用来将socks5协议的代理通道转化为http格式的代理通道，原因是之前在实际操作中发现很多FQ失败的应用都是对socks5协议缺少支持，或操作麻烦，索性将所有代理都转化为http协议的，这样就会为很多的应用提供方便的支持。


## 安装privoxy

```
sudo apt install privoxy
```

## 配置Privoxy

打开 `/etc/privoxy/config`

注释掉 `listen-address  localhost:8118`

在配置文件的最后加上

```
forward-socks5 / 127.0.0.1:1080 .
listen-address 127.0.0.1:8118
```

意思是在本地8118端口开设了一个http协议的代理通道，出口是本地的1080端口，协议是socks5协议，而那里正是shadowsocks的客户端在监听。

## 重启Privoxy

```
sudo service privoxy restart
```

# 总结

至此，可以认为linux系统中在本地8118端口中存在一个神奇的HTTP代理或HTTPS代理，其他的任何应用都可以对其进行利用。




